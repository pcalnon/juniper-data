#!/usr/bin/env bash
#####################################################################################################################################################################################################
# Project:       Juniper
# Sub-Project:   JuniperData
# Application:   juniper_data
# Purpose:       Juniper Project Cascade Correlation Neural Network
#
# Author:        Paul Calnon
# Version:       0.1.4 (0.7.3)
# File Name:     juniper_data_functions.conf
# File Path:     <Project>/<Sub-Project>/<Application>/conf/
#
# Date Created:  2026-01-20
# Last Modified: 2026-01-20
#
# License:       MIT License
# Copyright:     Copyright (c) 2024,2025,2026 Paul Calnon
#
# Description:
#    This Script serves as the functions config file for the Juniper Project's juniper_data prototype
#    Warning:  This Script / Config file is sourced by the try.bash script
#
#####################################################################################################################################################################################################
# Notes:
#     Warning:  This Config file is sourced by the juniper_data.conf script
#
#     The primary use case for this Script is to be sourced by the try.bash script.
#     However, this script can also be run directly from the command line for testing purposes.
#     When run directly from the command line, this script will output debug information based on the DEBUG constant defined within the script.
#     A convenience script, ~/Development/python/Juniper/JuniperData/juniper_data/conf/test_prototype_conf.bash, is provided for testing this config file.
#
#####################################################################################################################################################################################################
# References:
#
#####################################################################################################################################################################################################
# TODO :
#
#####################################################################################################################################################################################################
# COMPLETED:
#
#####################################################################################################################################################################################################


#####################################################################################################################################################################################################
# Check if this config file has already been sourced.  Only Source this conf file Once
#####################################################################################################################################################################################################
if [[ "${JUNIPER_DATA_FUNCTIONS_CONF_SOURCED}" != "${TRUE}" ]]; then
    JUNIPER_DATA_FUNCTIONS_CONF_SOURCED="${TRUE}"
else
    log_warning "juniper_data_functions.conf already sourced.  Skipping re-source."
    return $(( TRUE ))
fi


#####################################################################################################################################################################################################
# Define juniper_data.bash Script functions
#####################################################################################################################################################################################################
function set_language_path() {
    LANGUAGE="$1"    && log_debug "Language: \"${LANGUAGE}\""
    LANG_PATH="$2"   && log_debug "Lang Path: \"${LANG_PATH}\""
    MAJ_VER="$3"     && log_debug "Major Version: \"${MAJ_VER}\""
    MIN_VER="$4"     && log_debug "Minor Version: \"${MIN_VER}\""
    LANG_NAME="$5"   && log_debug "Language Name: \"${LANG_NAME}\""

    [[ "${LANG_NAME}" == "${LANGUAGE}" ]] && LANGUAGE="${LANG_NAME}${MAJ_VER}${MIN_VER}"
    LANGUAGE_ABS_PATH="${LANG_PATH}${PATH_DELIMITER}${LANGUAGE}"
    log_debug "Initial Language Name: ${LANGUAGE_NAME}"
    [[ "${LANGUAGE_NAME}" == "" ]] && LANGUAGE_NAME="${LANG_NAME}"
    log_debug "Final Language Name: ${LANGUAGE_NAME}"
    log_debug "Initial Language Path: ${LANGUAGE_PATH}"
    [[ "${LANGUAGE_PATH}" == "" ]] && LANGUAGE_PATH="${LANGUAGE_ABS_PATH}"
    log_debug "Final Language Path: ${LANGUAGE_PATH}"
    log_debug "Initial Language Vers: ${LANGUAGE_VERS}"
    [[ "${LANGUAGE_VERS}" == "" ]] && LANGUAGE_VERS="${MAJ_VER}${MIN_VER}"
    log_debug "Final Language Vers: ${LANGUAGE_VERS}"

    eval "export ${LANG_NAME^^}=\"${LANGUAGE_ABS_PATH}\""
}

function contains() {
    local ITEM="$1" && shift
    for ELEMENT in "${@}"; do
        if [[ "${ELEMENT}" == "${ITEM}" ]]; then
            return 0
        fi
    done
    return 1
}

function get_index() {
    local ITEM="$1" && shift
    log_verbose "Item: \"${ITEM}\""
    local LIST=($*)
    log_verbose "List: \"${LIST[*]}\""
    local NUM_ELEMENTS="${#LIST[@]}"
    log_verbose "Num Elements: ${NUM_ELEMENTS}"
    local INDEX=0
    for ELEMENT in ${LIST[*]}; do
        log_verbose "Element: \"${ELEMENT}\""
        if [[ "${ELEMENT}" == "${ITEM}" ]]; then
            log_verbose "Index: ${INDEX}"
            break
        fi
        INDEX="$(( INDEX + 1 ))"
    done
    (( INDEX >= NUM_ELEMENTS )) && INDEX="${NOT_FOUND}"
    log_verbose "Index: ${INDEX}"
    export LANGUAGE_INDEX="${INDEX}"
    return 1
}


#####################################################################################################################################################################################################
# Export Juniper Data config script Functions
#####################################################################################################################################################################################################
export -f set_language_path
export -f contains
export -f get_index

return $(( TRUE ))
